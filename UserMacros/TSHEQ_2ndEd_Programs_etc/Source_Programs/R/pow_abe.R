m <- 12
n <- 13
alpha <- 0.05
del_0 <- log(1.25)
del <- del_0/2
sig <- 0.175624

mpln <- m + n
lcon <- 0.5*log(mpln-2) + (2-mpln/2)*log(2) - lgamma(mpln/2 - 1)
sqmn <- sqrt(m*n/mpln)
t_al <- qt(1-alpha,mpln-2)
vm <- sqmn*2*(del_0/sig)/t_al

a <- vm/2
B <- vm
C <- rep(NA,48)
G <- rep(NA,48)

      C[1] <-  0.5*.999689503883230766828E0*B
      G[1] <-  0.5*.000796792065552012429E0
      C[2] <-  0.5*.998364375863181677724E0*B
      G[2] <-  0.5*.001853960788946921732E0
      C[3] <-  0.5*.995981842987209290650E0*B
      G[3] <-  0.5*.002910731817934946408E0
      C[4] <-  0.5*.992543900323762624572E0*B
      G[4] <-  0.5*.003964554338444686674E0
      C[5] <-  0.5*.988054126329623799481E0*B
      G[5] <-  0.5*.005014202742927517693E0
      C[6] <-  0.5*.982517263563014677447E0*B
      G[6] <-  0.5*.006058545504235961683E0
      C[7] <-  0.5*.975939174585136466453E0*B
      G[7] <-  0.5*.007096470791153865269E0
      C[8] <-  0.5*.968326828463264212174E0*B
      G[8] <-  0.5*.008126876925698759217E0
      C[9] <-  0.5*.959688291448742539300E0*B
      G[9] <-  0.5*.009148671230783386633E0
      C[10] <-  0.5*.950032717784437635756E0*B
      G[10] <-  0.5*.010160770535008415758E0
      C[11] <-  0.5*.939370339752755216932E0*B
      G[11] <-  0.5*.011162102099838498591E0
      C[12] <-  0.5*.927712456722308690965E0*B
      G[12] <-  0.5*.012151604671088319635E0
      C[13] <-  0.5*.915071423120898074206E0*B
      G[13] <-  0.5*.013128229566961572637E0
      C[14] <-  0.5*.901460635315852341319E0*B
      G[14] <-  0.5*.014090941772314860916E0
      C[15] <-  0.5*.886894517402420416057E0*B
      G[15] <-  0.5*.015038721026994938006E0
      C[16] <-  0.5*.871388505909296502874E0*B
      G[16] <-  0.5*.015970562902562291381E0
      C[17] <-  0.5*.854959033434601455463E0*B
      G[17] <-  0.5*.016885479864245172450E0
      C[18] <-  0.5*.837623511228187121494E0*B
      G[18] <-  0.5*.017782502316045260838E0
      C[19] <-  0.5*.819400310737931675539E0*B
      G[19] <-  0.5*.018660679627411467385E0
      C[20] <-  0.5*.800308744139140817229E0*B
      G[20] <-  0.5*.019519081140145022410E0
      C[21] <-  0.5*.780369043867433217604E0*B
      G[21] <-  0.5*.020356797154333324595E0
      C[22] <-  0.5*.759602341176647498703E0*B
      G[22] <-  0.5*.021172939892191298988E0
      C[23] <-  0.5*.738030643744400132851E0*B
      G[23] <-  0.5*.021966644438744349195E0
      C[24] <-  0.5*.715676812348967626225E0*B
      G[24] <-  0.5*.022737069658329374001E0
      C[25] <-  0.5*.692564536642171561344E0*B
      G[25] <-  0.5*.023483399085926219842E0
      C[26] <-  0.5*.668718310043916153953E0*B
      G[26] <-  0.5*.024204841792364691282E0
      C[27] <-  0.5*.644163403784967106798E0*B
      G[27] <-  0.5*.024900633222483610288E0
      C[28] <-  0.5*.618925840125468570386E0*B
      G[28] <-  0.5*.025570036005349361499E0
      C[29] <-  0.5*.593032364777572080684E0*B
      G[29] <-  0.5*.026212340735672413913E0
      C[30] <-  0.5*.566510418561397168404E0*B
      G[30] <-  0.5*.026826866725591762198E0
      C[31] <-  0.5*.539388108324357436227E0*B
      G[31] <-  0.5*.027412962726029242823E0
      C[32] <-  0.5*.511694177154667673586E0*B
      G[32] <-  0.5*.027970007616848334440E0
      C[33] <-  0.5*.483457973920596359768E0*B
      G[33] <-  0.5*.028497411065085385646E0
      C[34] <-  0.5*.454709422167743008636E0*B
      G[34] <-  0.5*.028994614150555236543E0
      C[35] <-  0.5*.425478988407300545365E0*B
      G[35] <-  0.5*.029461089958167905970E0
      C[36] <-  0.5*.395797649828908603285E0*B
      G[36] <-  0.5*.029896344136328385984E0
      C[37] <-  0.5*.365696861472313635031E0*B
      G[37] <-  0.5*.030299915420827593794E0
      C[38] <-  0.5*.335208522892625422616E0*B
      G[38] <-  0.5*.030671376123669149014E0
      C[39] <-  0.5*.304364944354496353024E0*B
      G[39] <-  0.5*.031010332586313837423E0
      C[40] <-  0.5*.273198812591049141487E0*B
      G[40] <-  0.5*.031316425596861355813E0
      C[41] <-  0.5*.241743156163840012328E0*B
      G[41] <-  0.5*.031589330770727168558E0
      C[42] <-  0.5*.210031310460567203603E0*B
      G[42] <-  0.5*.031828758894411006535E0
      C[43] <-  0.5*.178096882367618602759E0*B
      G[43] <-  0.5*.032034456231992663218E0
      C[44] <-  0.5*.145973714654896941989E0*B
      G[44] <-  0.5*.032206204794030250669E0
      C[45] <-  0.5*.113695850110665920911E0*B
      G[45] <-  0.5*.032343822568575928429E0
      C[46] <-  0.5*.081297495464425558994E0*B
      G[46] <-  0.5*.032447163714064269364E0
      C[47] <-  0.5*.048812985136049731112E0*B
      G[47] <-  0.5*.032516118713868835987E0
      C[48] <-  0.5*.016276744849602969579E0*B
      G[48] <-  0.5*.032550614492363166242E0

y <- 0

for (j in 1:48)
   {
    cj <- C[j]
    vr <- a + cj
    ur <- sqrt(mpln-2)*vr
    normr2 <- pnorm(sqmn*2*(del_0-del)/sig - vr*t_al)
    normr1 <- pnorm(-sqmn*2*(del_0+del)/sig + vr*t_al)
    normr  <- normr2 - normr1
    if (normr != 0)
      { itgdrlog <- log(normr) + lcon - ur**2/2 + (mpln-3)*log(ur)
        itgdr <- exp(itgdrlog)  }
    vl <- a-cj
    ul <- sqrt(mpln-2)*vl
    norml2 <- pnorm(sqmn*2*(del_0-del)/sig - vl*t_al)
    norml1 <- pnorm(-sqmn*2*(del_0+del)/sig + vl*t_al)
    norml  <- norml2 - norml1
    if (norml != 0)
      { itgdllog <- log(norml) + lcon - ul**2/2 + (mpln-3)*log(ul)
        itgdl <- exp(itgdllog) 
        y <-  y + G[j]*(itgdr+itgdl)  }     }

pow_abe <- B*y

cat(" M =",m,"  N =",n," ALPHA =",alpha,"   DEL_0 =",del_0,"   DEL =",del,
    "   SIG =",sig,"   POW_ABE =",pow_abe)   
